########################################################################################################################
ARG     PHP_VERSION="${PHP_VERSION:-7.2}"
FROM    php:${PHP_VERSION}-fpm
########################################################################################################################
LABEL   Maintainer  =   "Haseeb Memon <memon.haseeb@hotmail.com>"
LABEL   Description =   "php container for web development"
########################################################################################################################
RUN apt-get update && apt-get install -y \
  wget \
  git \
  libfreetype6-dev \
  libicu-dev \
  libjpeg62-turbo-dev \
  libmcrypt-dev \
  libpng-dev \
  libxslt-dev \
  lsof \
  vim \
  zip \
  libzip-dev
########################################################################################################################
# Clear cache
RUN apt-get clean && rm -rf /var/lib/apt/lists/* && rm -rf /tmp/*
########################################################################################################################
########################################################################################################################
RUN docker-php-ext-configure \
	gd --with-jpeg-dir=/usr/local/ --with-freetype-dir=/usr/include/
RUN docker-php-ext-configure zip --with-libzip
########################################################################################################################
RUN docker-php-ext-install \
	gd \
	bcmath \
	intl \
	pdo_mysql \
	mysqli    \
	soap \
	xsl \
	zip
########################################################################################################################
ENV COMPOSER_ALLOW_SUPERUSER 1
########################################################################################################################
RUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer
########################################################################################################################
#Copy custom configs to container
COPY .docker/php/config/php.ini /usr/local/etc/php/php.ini
########################################################################################################################
WORKDIR /var/www/html/
########################################################################################################################
EXPOSE 9000
########################################################################################################################
CMD ["php-fpm"]